[![License: CC BY-NC-SA 4.0](https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-ff69b4.svg)](http://creativecommons.org/licenses/by-nc-sa/4.0/)

## Attribute-Regularized VAE (AR-VAE)

### About 
AR-VAE is a type of Variational Auto-Encoder (VAE) which uses a new supervised training method to create structured latent spaces where specific attributes are forced to be encoded along specific dimensions of the latent space. This repository contains the source for training and evaluating the AR-VAE models across different image and music-based datasets.

<figure align="center">
    <img src=figs/motivation_arvae.svg width=400px><br>
    <figcaption>Main idea behind the AR-VAE model.</figcaption>
</figure>

This repository contains the source for training and evaluating the AR-VAE models across different image and music-based datasets. 


### Results

**Manipulation of Image Attributes**

<figure align="center">
    <img src=figs/gif_interpolations_dsprites_0.gif><br>
    <img src=figs/gif_interpolations_dsprites_1.gif><br>
    <img src=figs/gif_interpolations_dsprites_4.gif><br>
    <figcaption>Manipulating attributes of 2-d shapes. Each row represents a unique shape (from top to bottom): <i>square, heart, ellipse</i>. Each column corresponds to traversal along a regularized dimension which encodes a specific attribute (from left to right): <i>Shape, Scale, Orientation, x-position, y-position</i> </figcaption>
</figure>

<figure align="center">
    <img src=figs/gif_interpolations_mnist_28.gif><br>
    <img src=figs/gif_interpolations_mnist_5.gif><br>
    <img src=figs/gif_interpolations_mnist_1.gif><br>
    <img src=figs/gif_interpolations_mnist_30.gif><br>
    <img src=figs/gif_interpolations_mnist_19.gif><br>
    <img src=figs/gif_interpolations_mnist_23.gif><br>
    <img src=figs/gif_interpolations_mnist_21.gif><br>
    <img src=figs/gif_interpolations_mnist_17.gif><br>
    <img src=figs/gif_interpolations_mnist_61.gif><br>
    <img src=figs/gif_interpolations_mnist_9.gif><br>
    <figcaption>Manipulating attributes of MNIST digits. Each row represents a unique digit fronm 0 to 9. Each column corresponds to traversal along a regularized dimension which encodes a specific attribute (from left to right): <i>Area, Length, Thickness, Slant, Width, Height</i> </figcaption>
</figure>

**Manipulation of Musical Attributes**
<figure align="center">
    <img src=figs/interp_score_15_11.svg><br>
    <figcaption>Manipulating attributes of monophonic measures of music. Measures in each score line are generated by traversal along a regularized dimension which encodes a specific musical attribute (shown on the extreme left)  </figcaption>
</figure>

<figure align="center">
    <img src=figs/interp_pianoroll_15_11.svg><br>
    <figcaption>Piano roll version of the figure above. Plots on the right of each pianoroll show the progression of attribute values </figcaption>
</figure>


### Installation and Usage
Install `anaconda` or `miniconda` by following the instruction [here](https://docs.conda.io/projects/conda/en/latest/user-guide/install/).

Create a new conda environment using the `enviroment.yml` file located in the root folder of this repository. The instructions for the same can be found [here](https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#creating-an-environment-from-an-environment-yml-file).

To install, either download / clone this repository. Open a new terminal, `cd` into the root folder of this repository and run the following command

    pip install -e .

**Downloading Datasets:** TO BE UPDATED

### Contents
The contents of this repository are as follows: 
* `data`: contains the data and pytorch `dataloaders` for the different datasets.
* `imagevae`: module implementing the AR-VAE network and trainer for image datasets.
* `measurevae`: module implemening the AR-VAE network and trainer for music datasets. 
* `imagefader`: module implementing the fader network and trainer for image datasets.
* `figs`: contains figures and plots for different experiments.
* `utils`: module with utility classes and methods for model, training, evaluation and plotting.

* other scripts to train / test the models

### Attribution

TO BE UPDATED